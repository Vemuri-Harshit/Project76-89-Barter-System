{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\dell\\\\OneDrive\\\\Documents\\\\harshit\\\\Coding\\\\White hat junior downloads\\\\React\\\\Project76-89-Barter-System\\\\screens\\\\MyDonationsScreen.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Card, Icon, ListItem } from 'react-native-elements';\nimport MyHeader from \"../components/MyHeader.js\";\nimport firebase from 'firebase';\nimport db from \"../config.js\";\n\nvar MyDonationsScreen = function (_Component) {\n  _inherits(MyDonationsScreen, _Component);\n\n  var _super = _createSuper(MyDonationsScreen);\n\n  function MyDonationsScreen() {\n    var _this;\n\n    _classCallCheck(this, MyDonationsScreen);\n\n    _this = _super.call(this);\n\n    _this.getDonorDetails = function (donorId) {\n      db.collection(\"users\").where(\"email_id\", \"==\", donorId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          _this.setState({\n            \"donorName\": doc.data().first_name + \" \" + doc.data().last_name\n          });\n        });\n      });\n    };\n\n    _this.getAllDonations = function () {\n      _this.requestRef = db.collection(\"donated_items\").where(\"donor_id\", '==', _this.state.donorId).onSnapshot(function (snapshot) {\n        var allDonations = [];\n        snapshot.docs.map(function (doc) {\n          var donation = doc.data();\n          donation[\"doc_id\"] = doc.id;\n          allDonations.push(donation);\n        });\n\n        _this.setState({\n          allDonations: allDonations\n        });\n      });\n    };\n\n    _this.sendItem = function (itemDetails) {\n      if (itemDetails.request_status === \"Item Sent\") {\n        var requestStatus = \"Donor Interested\";\n        db.collection(\"donated_items\").doc(itemDetails.doc_id).update({\n          \"request_status\": \"Donor Interested\"\n        });\n\n        _this.sendNotification(itemDetails, requestStatus);\n      } else {\n        var requestStatus = \"Item Sent\";\n        db.collection(\"donated_items\").doc(itemDetails.doc_id).update({\n          \"request_status\": \"Item Sent\"\n        });\n\n        _this.sendNotification(itemDetails, requestStatus);\n      }\n    };\n\n    _this.sendNotification = function (itemDetails, requestStatus) {\n      var requestId = itemDetails.request_id;\n      var donorId = itemDetails.donor_id;\n      db.collection(\"all_notifications\").where(\"request_id\", \"==\", requestId).where(\"donor_id\", \"==\", donorId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          var message = \"\";\n\n          if (requestStatus === \"Item Sent\") {\n            message = _this.state.donorName + \" sent you the item\";\n          } else {\n            message = _this.state.donorName + \" has shown interest in donating the item\";\n          }\n\n          db.collection(\"all_notifications\").doc(doc.id).update({\n            \"message\": message,\n            \"notification_status\": \"unread\",\n            \"date\": firebase.firestore.FieldValue.serverTimestamp()\n          });\n        });\n      });\n    };\n\n    _this.keyExtractor = function (item, index) {\n      return index.toString();\n    };\n\n    _this.renderItem = function (_ref) {\n      var item = _ref.item,\n          i = _ref.i;\n      return React.createElement(ListItem, {\n        key: i,\n        title: item.item_name,\n        subtitle: \"Requested By : \" + item.requested_by + \"\\nStatus : \" + item.request_status,\n        leftElement: React.createElement(Icon, {\n          name: \"book\",\n          type: \"font-awesome\",\n          color: \"#696969\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 21\n          }\n        }),\n        titleStyle: {\n          color: 'black',\n          fontWeight: 'bold'\n        },\n        rightElement: React.createElement(TouchableOpacity, {\n          style: [styles.button, {\n            backgroundColor: item.request_status === \"Item Sent\" ? \"green\" : \"#ff5722\"\n          }],\n          onPress: function onPress() {\n            _this.sendItem(item);\n\n            _this.setState({\n              buttonDisabled: true\n            });\n          },\n          disabled: _this.state.buttonDisabled,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 12\n          }\n        }, React.createElement(Text, {\n          style: {\n            color: '#ffff'\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 14\n          }\n        }, item.request_status === \"Item Sent\" ? \"Item Sent\" : \"Send Item\")),\n        bottomDivider: true,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 6\n        }\n      });\n    };\n\n    _this.state = {\n      donorId: firebase.auth().currentUser.email,\n      donorName: \"\",\n      allDonations: [],\n      buttonDisabled: false\n    };\n    _this.requestRef = null;\n    return _this;\n  }\n\n  _createClass(MyDonationsScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getDonorDetails(this.state.donorId);\n      this.getAllDonations();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.requestRef();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 8\n        }\n      }, React.createElement(MyHeader, {\n        navigation: this.props.navigation,\n        title: \"My Donations\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 10\n        }\n      }), React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 10\n        }\n      }, this.state.allDonations.length === 0 ? React.createElement(View, {\n        style: styles.subtitle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 16\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 20\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 18\n        }\n      }, \"List of all Donations\")) : React.createElement(FlatList, {\n        keyExtractor: this.keyExtractor,\n        data: this.state.allDonations,\n        renderItem: this.renderItem,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 16\n        }\n      })));\n    }\n  }]);\n\n  return MyDonationsScreen;\n}(Component);\n\nMyDonationsScreen.navigationOptions = {\n  header: null\n};\nexport { MyDonationsScreen as default };\nvar styles = StyleSheet.create({\n  button: {\n    width: 100,\n    height: 30,\n    justifyContent: 'center',\n    alignItems: 'center',\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 8\n    },\n    elevation: 16\n  },\n  subtitle: {\n    flex: 1,\n    fontSize: 20,\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n});","map":{"version":3,"sources":["C:/Users/dell/OneDrive/Documents/harshit/Coding/White hat junior downloads/React/Project76-89-Barter-System/screens/MyDonationsScreen.js"],"names":["React","Component","Card","Icon","ListItem","MyHeader","firebase","db","MyDonationsScreen","getDonorDetails","donorId","collection","where","get","then","snapshot","forEach","doc","setState","data","first_name","last_name","getAllDonations","requestRef","state","onSnapshot","allDonations","docs","map","donation","id","push","sendItem","itemDetails","request_status","requestStatus","doc_id","update","sendNotification","requestId","request_id","donor_id","message","donorName","firestore","FieldValue","serverTimestamp","keyExtractor","item","index","toString","renderItem","i","item_name","requested_by","color","fontWeight","styles","button","backgroundColor","buttonDisabled","auth","currentUser","email","flex","props","navigation","length","subtitle","fontSize","navigationOptions","header","StyleSheet","create","width","height","justifyContent","alignItems","shadowColor","shadowOffset","elevation"],"mappings":"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","sourcesContent":["import React ,{Component} from 'react'\r\nimport {View, Text,TouchableOpacity,ScrollView,FlatList,StyleSheet} from 'react-native';\r\nimport {Card,Icon,ListItem} from 'react-native-elements'\r\nimport MyHeader from '../components/MyHeader.js'\r\nimport firebase from 'firebase';\r\nimport db from '../config.js'\r\n\r\nexport default class MyDonationsScreen extends Component {\r\n   constructor(){\r\n     super()\r\n     this.state = {\r\n       donorId : firebase.auth().currentUser.email,\r\n       donorName : \"\",\r\n       allDonations : [],\r\n       buttonDisabled : false\r\n     }\r\n     this.requestRef= null\r\n   }\r\n\r\n   static navigationOptions = { header: null };\r\n\r\n   getDonorDetails=(donorId)=>{\r\n     db.collection(\"users\").where(\"email_id\",\"==\", donorId).get()\r\n     .then((snapshot)=>{\r\n       snapshot.forEach((doc) => {\r\n         this.setState({\r\n           \"donorName\" : doc.data().first_name + \" \" + doc.data().last_name\r\n         })\r\n       });\r\n     })\r\n   }\r\n\r\n   getAllDonations =()=>{\r\n     this.requestRef = db.collection(\"donated_items\").where(\"donor_id\" ,'==', this.state.donorId)\r\n     .onSnapshot((snapshot)=>{\r\n       var allDonations = []\r\n       snapshot.docs.map((doc) =>{\r\n         var donation = doc.data()\r\n         donation[\"doc_id\"] = doc.id\r\n         allDonations.push(donation)\r\n       });\r\n       this.setState({\r\n         allDonations : allDonations\r\n       });\r\n     })\r\n   }\r\n\r\n   sendItem=(itemDetails)=>{\r\n     if(itemDetails.request_status === \"Item Sent\"){\r\n       var requestStatus = \"Donor Interested\"\r\n       db.collection(\"donated_items\").doc(itemDetails.doc_id).update({\r\n         \"request_status\" : \"Donor Interested\"\r\n       })\r\n       this.sendNotification(itemDetails,requestStatus)\r\n     }\r\n     else{\r\n       var requestStatus = \"Item Sent\"\r\n       db.collection(\"donated_items\").doc(itemDetails.doc_id).update({\r\n         \"request_status\" : \"Item Sent\"\r\n       })\r\n       this.sendNotification(itemDetails,requestStatus)\r\n     }\r\n   }\r\n\r\n   sendNotification=(itemDetails,requestStatus)=>{\r\n     var requestId = itemDetails.request_id\r\n     var donorId = itemDetails.donor_id\r\n     db.collection(\"all_notifications\")\r\n     .where(\"request_id\",\"==\", requestId)\r\n     .where(\"donor_id\",\"==\",donorId)\r\n     .get()\r\n     .then((snapshot)=>{\r\n       snapshot.forEach((doc) => {\r\n         var message = \"\"\r\n         if(requestStatus === \"Item Sent\"){\r\n           message = this.state.donorName + \" sent you the item\"\r\n         }else{\r\n            message =  this.state.donorName  + \" has shown interest in donating the item\"\r\n         }\r\n         db.collection(\"all_notifications\").doc(doc.id).update({\r\n           \"message\": message,\r\n           \"notification_status\" : \"unread\",\r\n           \"date\"                : firebase.firestore.FieldValue.serverTimestamp()\r\n         })\r\n       });\r\n     })\r\n   }\r\n\r\n   keyExtractor = (item, index) => index.toString()\r\n\r\n   renderItem = ( {item, i} ) =>(\r\n     <ListItem\r\n       key={i}\r\n       title={item.item_name}\r\n       subtitle={\"Requested By : \" + item.requested_by +\"\\nStatus : \" + item.request_status}\r\n       leftElement={<Icon name=\"book\" type=\"font-awesome\" color ='#696969'/>}\r\n       titleStyle={{ color: 'black', fontWeight: 'bold' }}\r\n       rightElement={\r\n           <TouchableOpacity\r\n            style={[\r\n              styles.button,\r\n              {\r\n                backgroundColor : item.request_status === \"Item Sent\" ? \"green\" : \"#ff5722\"\r\n              }\r\n            ]}\r\n            onPress = {()=>{\r\n              this.sendItem(item)\r\n              this.setState({\r\n                buttonDisabled: true\r\n              })\r\n            }}\r\n            disabled = {this.state.buttonDisabled}\r\n           >\r\n             <Text style={{color:'#ffff'}}>{\r\n               item.request_status === \"Item Sent\" ? \"Item Sent\" : \"Send Item\"\r\n             }</Text>\r\n           </TouchableOpacity>\r\n         }\r\n       bottomDivider\r\n     />\r\n   )\r\n\r\n\r\n   componentDidMount(){\r\n     this.getDonorDetails(this.state.donorId)\r\n     this.getAllDonations()\r\n   }\r\n\r\n   componentWillUnmount(){\r\n     this.requestRef();\r\n   }\r\n\r\n   render(){\r\n     return(\r\n       <View style={{flex:1}}>\r\n         <MyHeader navigation={this.props.navigation} title=\"My Donations\"/>\r\n         <View style={{flex:1}}>\r\n           {\r\n             this.state.allDonations.length === 0\r\n             ?(\r\n               <View style={styles.subtitle}>\r\n                 <Text style={{ fontSize: 20}}>List of all Donations</Text>\r\n               </View>\r\n             )\r\n             :(\r\n               <FlatList\r\n                 keyExtractor={this.keyExtractor}\r\n                 data={this.state.allDonations}\r\n                 renderItem={this.renderItem}\r\n               />\r\n             )\r\n           }\r\n         </View>\r\n       </View>\r\n     )\r\n   }\r\n   }\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n  button:{\r\n    width:100,\r\n    height:30,\r\n    justifyContent:'center',\r\n    alignItems:'center',\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n       width: 0,\r\n       height: 8\r\n     },\r\n    elevation : 16\r\n  },\r\n  subtitle :{\r\n    flex:1,\r\n    fontSize: 20,\r\n    justifyContent:'center',\r\n    alignItems:'center'\r\n  }\r\n})"]},"metadata":{},"sourceType":"module"}